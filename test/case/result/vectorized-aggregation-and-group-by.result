INITIALIZATION
SET EXECUTION_MODE='CHUNK_ITERATOR';
SUCCESS
CREATE TABLE AGGREGATION_FUNC(ID INT, NUM INT, PRICE FLOAT, ADDR CHAR) STORAGE FORMAT=PAX;
SUCCESS

INSERT INTO AGGREGATION_FUNC VALUES (1, 18, 10.0, 'ABC');
SUCCESS
INSERT INTO AGGREGATION_FUNC VALUES (2, 15, 20.0, 'ABC');
SUCCESS
INSERT INTO AGGREGATION_FUNC VALUES (3, 12, 30.0, 'DEF');
SUCCESS
INSERT INTO AGGREGATION_FUNC VALUES (4, 15, 30.0, 'DEI');
SUCCESS
INSERT INTO AGGREGATION_FUNC VALUES (4, 15, 31.11, 'CEI');
SUCCESS
INSERT INTO AGGREGATION_FUNC VALUES (4, 13, 2.22, 'WEI');
SUCCESS



1. UNGROUPED AGGREGATION

SELECT SUM(NUM) FROM AGGREGATION_FUNC;
88
SUM(NUM)

SELECT SUM(NUM), SUM(PRICE) FROM AGGREGATION_FUNC;
88 | 123.33
SUM(NUM) | SUM(PRICE)

SELECT SUM(NUM) FROM AGGREGATION_FUNC WHERE ID>1;
70
SUM(NUM)

SELECT SUM(NUM) FROM AGGREGATION_FUNC WHERE ID<=3;
45
SUM(NUM)

SELECT SUM(NUM) FROM AGGREGATION_FUNC WHERE ID>=2 AND ID<=3;
27
SUM(NUM)

2. GROUP BY
SELECT NUM, SUM(PRICE) FROM AGGREGATION_FUNC GROUP BY NUM;
12 | 30
13 | 2.22
15 | 81.11
18 | 10
NUM | SUM(PRICE)

SELECT NUM, SUM(PRICE) FROM AGGREGATION_FUNC WHERE ID>=2 GROUP BY NUM;
12 | 30
13 | 2.22
15 | 81.11
NUM | SUM(PRICE)

SELECT ID, SUM(PRICE) FROM AGGREGATION_FUNC GROUP BY ID;
1 | 10
2 | 20
3 | 30
4 | 63.33
ID | SUM(PRICE)

SELECT SUM(PRICE), ID FROM AGGREGATION_FUNC GROUP BY ID;
10 | 1
20 | 2
30 | 3
63.33 | 4
SUM(PRICE) | ID

SELECT ID, NUM, SUM(PRICE) FROM AGGREGATION_FUNC GROUP BY ID, NUM;
1 | 18 | 10
2 | 15 | 20
3 | 12 | 30
4 | 13 | 2.22
4 | 15 | 61.11
ID | NUM | SUM(PRICE)

SELECT ID, SUM(PRICE), NUM FROM AGGREGATION_FUNC GROUP BY ID, NUM;
1 | 10 | 18
2 | 20 | 15
3 | 30 | 12
4 | 2.22 | 13
4 | 61.11 | 15
ID | SUM(PRICE) | NUM

SELECT ID, SUM(NUM + 1), PRICE FROM AGGREGATION_FUNC GROUP BY ID, PRICE;
1 | 19 | 10
2 | 16 | 20
3 | 13 | 30
4 | 14 | 2.22
4 | 16 | 30
4 | 16 | 31.11
ID | SUM(NUM + 1) | PRICE

SELECT ID, SUM(PRICE+PRICE), NUM FROM AGGREGATION_FUNC GROUP BY ID, NUM;
1 | 20 | 18
2 | 40 | 15
3 | 60 | 12
4 | 122.22 | 15
4 | 4.44 | 13
ID | SUM(PRICE+PRICE) | NUM

SELECT ID+ID-ID, SUM(NUM)+ID+1 FROM AGGREGATION_FUNC GROUP BY ID;
1 | 20
2 | 18
3 | 16
4 | 48
ID+ID-ID | SUM(NUM)+ID+1

SELECT ID+1, SUM(NUM)+SUM(NUM) FROM AGGREGATION_FUNC GROUP BY ID;
2 | 36
3 | 30
4 | 24
5 | 86
ID+1 | SUM(NUM)+SUM(NUM)

SELECT ID+ID+1, SUM(NUM)+SUM(NUM) FROM AGGREGATION_FUNC GROUP BY ID+ID;
3 | 36
5 | 30
7 | 24
9 | 86
ID+ID+1 | SUM(NUM)+SUM(NUM)

SELECT (ID+ID)+(ID+ID), SUM(NUM)+SUM(NUM) FROM AGGREGATION_FUNC GROUP BY ID+ID;
(ID+ID)+(ID+ID) | SUM(NUM)+SUM(NUM)
12 | 24
16 | 86
4 | 36
8 | 30

SELECT ID+ID, SUM(NUM) + 1 + SUM(NUM), PRICE FROM AGGREGATION_FUNC GROUP BY ID+ID, PRICE;
2 | 37 | 10
4 | 31 | 20
6 | 25 | 30
8 | 27 | 2.22
8 | 31 | 30
8 | 31 | 31.11
ID+ID | SUM(NUM) + 1 + SUM(NUM) | PRICE

SELECT ID+NUM+ID+NUM, SUM(PRICE+PRICE) FROM AGGREGATION_FUNC GROUP BY ID+NUM;
FAILURE

SELECT (ID+NUM)+(ID+NUM), SUM(PRICE+PRICE) FROM AGGREGATION_FUNC GROUP BY ID+NUM;
(ID+NUM)+(ID+NUM) | SUM(PRICE+PRICE)
30 | 60
34 | 44.44
38 | 142.22

SELECT ADDR, SUM(ID+ID) FROM AGGREGATION_FUNC GROUP BY ADDR;
ABC | 6
ADDR | SUM(ID+ID)
CEI | 8
DEF | 6
DEI | 8
WEI | 8

SELECT ADDR, SUM(PRICE+PRICE) FROM AGGREGATION_FUNC GROUP BY ADDR;
ABC | 60
ADDR | SUM(PRICE+PRICE)
CEI | 62.22
DEF | 60
DEI | 60
WEI | 4.44

EXPLAIN SELECT ID, SUM(PRICE+PRICE), NUM FROM AGGREGATION_FUNC GROUP BY ID, NUM;
QUERY PLAN
OPERATOR(NAME)
PROJECT_VEC
└─EXPR_VEC
  └─GROUP_BY_VEC
    └─TABLE_SCAN_VEC(AGGREGATION_FUNC)
